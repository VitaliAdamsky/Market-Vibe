<div class="tooltip-box">
  <!-- Header -->
  <div class="header-row">
    <div class="header">
      <img [src]="data.imageUrl" class="tooltip-image header-icon" alt="logo" (click)="onGoToCoinMetrics()" />
      <h3>{{ stripPair(data.symbol) }}</h3>
    </div>
    <mat-icon class="close-icon" (click)="closeTooltip()">close</mat-icon>
  </div>

  <!-- Time Info -->
  <div class="row tooltip-date">
    <span class="label">Open:</span>
    <span class="data">{{ data.openTime | date:'HH:mm dd MMM yy' }}</span>
  </div>
  <div class="row tooltip-date">
    <span class="label">Close:</span>
    <span class="data">{{ data.closeTime | date:'HH:mm dd MMM yy' }}</span>
  </div>

  <hr />

  <!-- === Normalized Metrics First === -->
  <div class="row" *ngIf="data.normalizedFundingRate">
    <span class="label">FR:</span>
    <span class="data">{{ data.fundingRate }}</span>
  </div>

  <div class="row" *ngIf="data.normalizedOpenInterest">
    <span class="label">Norm OI:</span>
    <span class="data">{{ data.normalizedOpenInterest }}</span>
  </div>

  <div class="row" *ngIf="data.normalizedClosePrice">
    <span class="label">Close Price Norm.:</span>
    <span class="data">{{ data.normalizedClosePrice }}</span>
  </div>

  <div class="row" *ngIf="data.normalizedQuoteVolume">
    <span class="label">Quote Volume Norm.:</span>
    <span class="data">{{ data.normalizedQuoteVolume }}</span>
  </div>

  <div class="row" *ngIf="data.normalizedBuyerRatio">
    <span class="label">Buyer Ratio Norm.:</span>
    <span class="data">{{ data.normalizedBuyerRatio }}</span>
  </div>

  <div class="row" *ngIf="data.normalizedVolumeDelta">
    <span class="label">Volume Delta Norm.:</span>
    <span class="data">{{ data.normalizedVolumeDelta }}</span>
  </div>

  <div class="row" *ngIf="data.normalizedPerpSpotDiff">
    <span class="label">Perp Spot Diff Norm.:</span>
    <span class="data">{{ data.normalizedPerpSpotDiff }}</span>
  </div>

  <hr />

  <!-- === Other Metrics (Changes & Raw) === -->
  <div class="row" *ngIf="data.fundingRateChange">
    <span class="label">FR Change:</span>
    <span class="data">{{ data.fundingRateChange }}%</span>
  </div>

  <div class="row" *ngIf="data.openInterestChange">
    <span class="label">OI Change:</span>
    <span class="data">{{ data.openInterestChange }}%</span>
  </div>

  <div class="row" *ngIf="data.closePriceChange">
    <span class="label">Close Price Change:</span>
    <span class="data">{{ data.closePriceChange }}%</span>
  </div>

  <div class="row" *ngIf="data.quoteVolumeChange">
    <span class="label">Quote Volume Change:</span>
    <span class="data">{{ data.quoteVolumeChange }}%</span>
  </div>

  <div class="row" *ngIf="data.buyerRatioChange">
    <span class="label">Buyer Ratio Change:</span>
    <span class="data">{{ data.buyerRatioChange }}%</span>
  </div>

  <div class="row" *ngIf="data.volumeDeltaChange">
    <span class="label">Volume Delta Change:</span>
    <span class="data">{{ data.volumeDeltaChange }}%</span>
  </div>

  <hr />


  <!-- <div class="row" *ngIf="data.volumeDelta">
    <span class="label">Volume Delta:</span>
    <span class="data">{{ data.volumeDelta }}</span>
  </div>    -->

  <div class="row" *ngIf="data.perpSpotDiff">
    <span class="label">Perp Spot Diff:</span>
    <span class="data">{{ data.perpSpotDiff }}%</span>
  </div>

  <!-- === Exchange & External Links === -->
  <div class="tooltip-exchanges">
    <a [href]="coinLinksService.tradingViewLink(data.symbol, data.exchanges)" target="_blank">
      <img src="assets/img/tv-white.png" alt="TradingView" class="tooltip-image" />
    </a>
    <a [href]="coinLinksService.coinglassLink(data.symbol, data.exchanges)" target="_blank">
      <img src="assets/img/coinglass-white.png" alt="Coinglass" class="tooltip-image" />
    </a>

    <div style="display: inline-block;" *ngFor="let exchange of data.exchanges">
      <a [href]="coinLinksService.exchangeLink(data.symbol, exchange)" target="_blank">
        <img [src]="coinLinksService.exchangeLogoLink(exchange)" [alt]="exchange" class="tooltip-image" />
      </a>
    </div>
  </div>
</div>
